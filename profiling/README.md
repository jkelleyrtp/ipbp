# results of profiling with the new hot-reload engine

modifying nothing - just the mtime - of the docsite drops incremental compiles from 2s to 1.2s

Running the linker costs about 700ms or 1/3rd of the time of incremental compiles.

The more code you change, the longer the object generation takes.


## results

I expected macro expansion to be the most expensive operation, but it's not. But, in this case, it's likely because we've increased the optimization level of proc macros.

❯ summarize summarize dioxus_docs_site-custom-short-2.mm_profdata
+------------------------------------------------------+-----------+-----------------+----------+------------+-----------------------+---------------------------------+
| Item                                                 | Self time | % of total time | Time     | Item count | Incremental load time | Incremental result hashing time |
+------------------------------------------------------+-----------+-----------------+----------+------------+-----------------------+---------------------------------+
| codegen_copy_artifacts_from_incr_cache               | 396.14ms  | 29.398          | 396.14ms | 232        | 0.00ns                | 0.00ns                          |
+------------------------------------------------------+-----------+-----------------+----------+------------+-----------------------+---------------------------------+
| expand_proc_macro                                    | 78.25ms   | 5.807           | 78.25ms  | 187        | 0.00ns                | 0.00ns                          |
+------------------------------------------------------+-----------+-----------------+----------+------------+-----------------------+---------------------------------+
| expand_crate                                         | 63.38ms   | 4.704           | 176.06ms | 1          | 0.00ns                | 0.00ns                          |
+------------------------------------------------------+-----------+-----------------+----------+------------+-----------------------+---------------------------------+
| copy_all_cgu_workproducts_to_incr_comp_cache_dir     | 54.88ms   | 4.073           | 54.88ms  | 1          | 0.00ns                | 0.00ns                          |
+------------------------------------------------------+-----------+-----------------+----------+------------+-----------------------+---------------------------------+
| incr_comp_encode_dep_graph                           | 51.01ms   | 3.786           | 51.01ms  | 622756     | 0.00ns                | 0.00ns                          |
+------------------------------------------------------+-----------+-----------------+----------+------------+-----------------------+---------------------------------+
| late_resolve_crate                                   | 50.90ms   | 3.778           | 66.89ms  | 1          | 0.00ns                | 0.00ns                          |
+------------------------------------------------------+-----------+-----------------+----------+------------+-----------------------+---------------------------------+
| codegen_crate                                        | 50.28ms   | 3.731           | 214.72ms | 1          | 0.00ns                | 0.00ns                          |
+------------------------------------------------------+-----------+-----------------+----------+------------+-----------------------+---------------------------------+
| incr_comp_prepare_session_directory                  | 47.77ms   | 3.545           | 47.77ms  | 1          | 0.00ns                | 0.00ns                          |
+------------------------------------------------------+-----------+-----------------+----------+------------+-----------------------+---------------------------------+
| run_linker                                           | 46.64ms   | 3.461           | 46.64ms  | 1          | 0.00ns                | 0.00ns                          |
+------------------------------------------------------+-----------+-----------------+----------+------------+-----------------------+---------------------------------+
| LLVM_passes                                          | 45.52ms   | 3.378           | 45.52ms  | 1          | 0.00ns                | 0.00ns                          |
+------------------------------------------------------+-----------+-----------------+----------+------------+-----------------------+---------------------------------+
| metadata_register_crate                              | 41.19ms   | 3.057           | 156.22ms | 269        | 0.00ns                | 0.00ns                          |
+------------------------------------------------------+-----------+-----------------+----------+------------+-----------------------+---------------------------------+
| metadata_decode_entry_exported_symbols               | 38.57ms   | 2.862           | 38.57ms  | 269        | 0.00ns                | 0.00ns                          |
+------------------------------------------------------+-----------+-----------------+----------+------------+-----------------------+---------------------------------+
| hir_crate                                            | 37.49ms   | 2.782           | 54.83ms  | 1          | 0.00ns                | 1.54µs                          |
+------------------------------------------------------+-----------+-----------------+----------+------------+-----------------------+---------------------------------+
| <unknown>                                            | 35.10ms   | 2.605           | 35.10ms  | 4          | 35.09ms               | 0.00ns                          |
+------------------------------------------------------+-----------+-----------------+----------+------------+-----------------------+---------------------------------+
| encode_query_results_for                             | 28.13ms   | 2.087           | 28.13ms  | 61         | 0.00ns                | 0.00ns                          |
+------------------------------------------------------+-----------+-----------------+----------+------------+-----------------------+---------------------------------+
| monomorphization_collector_graph_walk                | 22.68ms   | 1.683           | 109.56ms | 1          | 0.00ns                | 0.00ns                          |
+------------------------------------------------------+-----------+-----------------+----------+------------+-----------------------+---------------------------------+
| incr_comp_query_cache_promotion                      | 20.33ms   | 1.509           | 55.43ms  | 1          | 0.00ns                | 0.00ns                          |
+------------------------------------------------------+-----------+-----------------+----------+------------+-----------------------+---------------------------------+
| incr_comp_load_dep_graph                             | 15.84ms   | 1.175           | 15.84ms  | 1          | 0.00ns                | 0.00ns                          |
+------------------------------------------------------+-----------+-----------------+----------+------------+-----------------------+---------------------------------+
| cgu_partitioning_place_items                         | 15.20ms   | 1.128           | 20.06ms  | 1          | 0.00ns                | 0.00ns                          |
+------------------------------------------------------+-----------+-----------------+----------+------------+-----------------------+---------------------------------+
| items_of_instance                                    | 14.52ms   | 1.077           | 14.52ms  | 0          | 14.52ms               | 0.00ns                          |
+------------------------------------------------------+-----------+-----------------+----------+------------+-----------------------+---------------------------------+
